import "tfplan/v2" as tfplan

# Find all public IP resources being created
public_ip_creates = filter tfplan.resource_changes as _, rc {
  rc.type == "azurerm_public_ip" and
  "create" in rc.change.actions
}

# Deny if any public IP is created
main = rule {
  length(public_ip_creates) == 0
}
